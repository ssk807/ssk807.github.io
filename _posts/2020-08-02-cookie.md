---
title: "Cookie & Session?"
excerpt: "Cookie와 Session이란?"
categories:
  - JAVA
tags:
  - JAVA
  - JSP
  - Servlet
  - Back-End
last_modifed_at: 2020-08-02
---  

## Cookie란?
- 프로그램에서 흔적을 남긴다. 여기서 흔적이란 서버와 클라이언트가 연결되었던 흔적을 남겨 나중에 다시한번 서버에 접속했을때 흔적을 이용하여 접속을 이어나가는데 사용하는 것을 뜻한다. 
원래 기존의 http에서 브라우저와 서버가 연결이 되는 경우를 살펴보면 클라이언트의 request -> 서버 response -> 연결해제 과정을 거친다. 이 과정을 보면 알 수 있듯이 한번만 연결이 되고 해제가 되는 것을 알 수 있다. 
연결을 유지하지 않는 이유는 하나의 서버에 많은 클라이언트가 붙기 때문에 모든 클라이언트와의 연결을 유지하는 것은 오버헤드가 생길 수 있기 때문이라고 한다. 우리가 평소에 로그인 상황을 생각해보면 한번의 로그인 이후에
 페이지를 새로고침 할때마다 로그인 정보가 날라가버리면 곤란하다. 따라서 해당 브라우저에 클라이언트와 서버와의 연결정보를 저장시켜놓는다. 이런 정보파일을 쿠키라고 한다.  
 
## Cookie 생성
- 로그인 페이지를 예로 들자면, 로그인 정보에 대한 데이터 처리를 하는 servlet에서 meberID란 name을 가진 cookie를 생성해준다.  
- 이 때, request를 요청한 브라우저와 연결했던 정보가 없다면 cookie를 생성.
```java
Cookie[] cookies = request.getCookies();
Cookie cookie = null;

for(Cookie c : cookies)
{
  if(c.getName().equals("memberID")) {
    cookie = c;
  }
}

if(cookie == null) {
			cookie = new Cookie("memberID", ID);
}
		
response.addCookie(cookie);
cookie.setMaxAge(60*60);  // 최대 한시간동안 유지.

```  

## jsp에서 cookie 확인  
- 만약 이미 한번 연결이 되었었다면 쿠키를 통해 확인을 해줄 수 있다. 따라서 jsp에서 cookie에 대한 정보를 받고 만약 있다면 login을 생략해준다.  
```xml
<%@ page language="java" contentType="text/html;charset=EUC-KR"
 pageEncoding="EUC-KR"%>
 <!DOCTYPE html>
 <html>
 	<head>
 		<meta charset="EUC-KR">
 		<title>Insert title here</title>
 	</head>
 	<body>
 	
 		<%
 			Cookie[] cookies = request.getCookies();
 			
      <!-- 만약 쿠키가 있고 연결정보가 있다면 -->
      
 			if(cookies != null){ 
 				for(Cookie c:cookies)
 				{
 					if(c.getName().equals("memberID")){
 						response.sendRedirect("loginOk.jsp");
 					}
 				}
 			}
 		%>
 	
 	</body>
 </html>
```  

## Session이란?  
- Session이란 cookie와 마찬가지로 연결정보를 저장하여 클라이언트와 서버와의 연결을 유지시킨다. 하지만 쿠키와의 차이점은 쿠키는 해당 브라우져에서 저장을 하지만 세션은 웹 컨테이너에서 생성이 되고 서버에서 저장이 된다.  

## Session 생성  
- 쿠키와 마찬가지로 로그인 페이지 환경을 가정하고 생성해보자.  
```java
HttpSession session = request.getSession();
session.setAttribute("memberID", mID);
```  
- 개인적으로 느낀 차이는 쿠키는 브라우져가 저장해야하기 때문에 response 객체를 통해 보내주는 것을 확인할 수 있다. 하지만 session같은 경우에는 새로운 session을 생성해주고 name과 value를 설정만 해주면 된다.  

## jsp에서 Session 확인  
```xml
<%@ page language="java" contentType="text/html;charset=EUC-KR"
 pageEncoding="EUC-KR"%>
 <!DOCTYPE html>
 <html>
 	<head>
 		<meta charset="EUC-KR">
 		<title>Insert title here</title>
 	</head>
 	<body>
 		<%
 		if(session.equals("memberID")){
 			response.sendRedirect("loginOk.jsp");
 		}
 		%>
 	</body>
 </html>
```
